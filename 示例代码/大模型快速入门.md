本文帮助您了解并按照步骤完成 API 调用模型，包括如何配置环境，使用 SDK 调用模型服务，便于您了解如何通过代码使用模型能力，进而集成到您的工作或者应用中。

> 快速入口，供您快速跳转到需要的内容：
>
> *   直接体验模型能力，访问[模型广场](URL_placeholder) <0xF0><0x9F><0x94><0x97>。
> *   有模型调用经验，查看[对话(Chat)-文本 API](URL_placeholder)或者[模型教程文本生成](URL_placeholder)。
> *   已有模型调用业务，迁移到 Doubao 大模型，可参考[兼容 OpenAI API](URL_placeholder)。

# 简介

通过代码调用模型服务，可以分为以下几步：

*   1.获取并配置 API Key
*   2.获取 Model ID
*   3.配置环境并发起调用

## 1. 获取并配置 API Key

### 获取 API Key

1.  打开并登录[方舟控制台-API Key 管理](URL_placeholder) 
2.  单击创建 API Key 按钮。
3.  在弹出的名称文本框中确认/更改 API Key 名称，单击创建。

```
+ 创建 API Key
```

| 名称             | API Key      |
| :--------------- | :----------- |
| api-key-2024-car | 87809152...  |

> **说明**
>
> *   请妥善保存好 API Key，强烈建议您不要将其直接写入到调用模型的代码中。
> *   Access Key 鉴权方式，请参见[Access Key 签名鉴权](URL_placeholder)。

### 配置 API Key 到环境变量

**macOS | Linux | Windows**

#### macOS

您希望 API Key 环境变量在当前用户的所有新会话中生效，可以添加永久性环境变量。

1.  打开在线终端，使用以下命令，查看默认 Shell 类型。
    ```shell
    echo $SHELL
    ```
    *   `/bin/zsh`：默认的 Shell 类型是 Zsh (Z shell)。
    *   `/bin/bash`：默认的 Shell 类型是 Bash。

    **Zsh**
2.  打开终端，使用以下命令来将环境变量设置追加到 `~/.zshrc` 中。将 `<ARK_API_KEY>` 替换为您的方舟 API Key。
    ```shell
    echo "export ARK_API_KEY='<ARK_API_KEY>'" >> ~/.zshrc
    ```
3.  使用以下命令使更改生效。
    ```shell
    source ~/.zshrc
    ```
4.  验证环境变量是否设置成功，在新的终端窗口，输入以下命令，如果返回您的 API Key，则表示设置成功。
    ```shell
    echo $ARK_API_KEY
    ```

## 2. 获取 Model ID

通过 Model ID 的方式快速调用模型。

1.  通过[模型列表](URL_placeholder)选择模型并获取所需模型的 ID (Model ID)。
2.  访问[开通管理页面](URL_placeholder) <0xF0><0x9F><0x94><0x97> 开通对应模型服务。

> **说明**
>
> 您也可以通过Endpoint ID来调用模型，获得限流、计费类型（前付费/后付费）、运行状态查询、监控、安全等高级能力，具体可参考[获取 Endpoint ID](URL_placeholder)。

## 3. 配置环境并发起调用


### Python

#### Python 安装

检查并安装 Python 版本，Python 版本需要 3.7 或以上。
您可以在终端中输入以下命令查看 Python 安装版本。

```shell
python -V
```

如果运行失败，您可以尝试使用下面命令再运行。

```shell
python3 -V
```

如果未安装或者版本不满足，请参考 [Python 安装教程](URL_placeholder) 安装，注意选择版本 3.7 及以上版本。

#### 方舟 Python SDK

1.  安装方舟 Python SDK。
    您可以在终端中输入以下命令，安装/升级方舟 Python SDK。
    ```shell
    pip install -U 'volcengine-python-sdk[ark]'
    ```
    如果您本地安装错误，可以尝试使用方法
    *   使用下面命令安装
        ```shell
        pip install -U 'volcengine-python-sdk[ark]'
        ```
    *   Windows系统安装SDK失败, [ERROR: Failed building wheel for volcengine-python-sdk](URL_placeholder)

2.  创建一个文件命名为 `ark_example.py` ，将下面示例代码拷贝进文件。
    ```python
import os
from openai import OpenAI

client = OpenAI(
    # 从环境变量中读取您的方舟API Key
    api_key=os.environ.get("ARK_API_KEY"), 
    base_url="https://ark.cn-beijing.volces.com/api/v3",
    )
completion = client.chat.completions.create(
    # 将推理接入点 <Model>替换为 Model ID
    model="<Model>",
    messages=[
        {"role": "user", "content": "你好"}
    ]
)
print(completion.choices[0].message)

    ```

3.  在终端窗口中，使用下面命令运行代码。稍等您可以在终端窗口中看到模型调用的返回结果，这样您就完成了您的首次方舟平台模型服务调用。
```shell
    python ark_example.py
```


